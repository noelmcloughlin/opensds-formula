###  opensds/stacks/defaults.sls
# vim: sts=2 ts=2 sw=2 et ai
#
devstack:
  conf:
    enabled_services: 'mysql,key'
    username: stack
    password: 'opensds@123'
    host_ipv4: '12.0.0.1'                  #Blank value causes ipv4 address auto-detection
    host_ipv6: ''                          #Blank value causes ipv6 address auto-detection
    keyport: '50040'                       #i.e. keystone
    cinder_endpoint: '8776/v2'
    servicename: 'opensds'
    servicetype: 'opensds'
    endpointname1: ''                      #Blank value causes auto-name (i.e. 'opensdsv0.2.0')
    project_domain_name: Default
    project_name: 'service'
    user_domain_name: 'Default'
  os_password: '{{ site.devstack.password }}'
  service_host: '{{ site.host_ipv4 }}'

cli:
  user:
    create:
      {{ site.devstack.servicename }}:
        options:
          domain: '{{ site.devstack.user_domain_name }}'
          password: '{{ site.devstack.password }}'
          project: '{{ site.devstack.project_name }}'
          enable: True
    delete:
      demo:
        options:
          domain: '{{ site.devstack.user_domain_name }}'
      alt_demo:
        options:
          domain: '{{ site.devstack.user_domain_name }}'
  group:
    create:
      service:
        options:
          domain: '{{ site.devstack.user_domain_name }}'
    add user:
      service:
        target:
          - '{{ site.devstack.servicename }}'
      admins:
        options:
          domain: '{{ site.devstack.user_domain_name }}'
        target:
          - admin
  role:
    add:
      admin:
        options:
          project: '{{ site.devstack.project_name }}'
          target:
            - '{{ site.devstack.servicename }}'
      service:
        options:
          project: '{{ site.devstack.project_name }}'
          group: service
  service:
    create:
      {{ site.devstack.servicetype }}:
        options:
          name: '{{ site.devstack.servicename }}'
          type: identity
        description: OpenSDS Block Storage
          enable: True
  endpoint:
    create:
      {% set point1 = site.devstack.endpointname1 or 'opensds' ~ site.release.opensds %}
      '{{ point1 }} public https://{{ site.host_ipv4 }}/{{ site.devstack.keyport }}/{{ release.opensds }}/%\(tenant_id\)s':
        options:
          region: RegionOne
          enable: True
      '{{ point1 }} internal https://{{ site.host_ipv4 }}/{{ site.devstack.keyport }}/{{ release.opensds }}/%\(tenant_id\)s':
        options:
          region: RegionOne
          enable: True
      '{{ point1 }} admin https://{{ site.host_ipv4 }}/{{ site.devstack.keyport }}/{{ release.opensds }}/%\(tenant_id\)s':
        options:
          region: RegionOne
          enable: True
  project:
    delete:
      demo:
        options:
          domain: '{{ site.devstack.project_domain_name }}'
      alt_demo:
        options:
          domain: '{{ site.devstack.project_domain_name }}'
      invisible_to_admin:
        options:
          domain: '{{ site.devstack.project_domain_name }}'

